(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{45:function(e,t,n){e.exports=n(91)},54:function(e,t,n){},73:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=73},91:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),c=n.n(o),i=n(44),s=(n(54),n(6)),l=n(7),u=n(8),m=n(9),d=n(42),p=n(15),v=n(16),h=n(2),f=n.n(h),b=n(13),g=n(11),y=n(12),E=n.n(y),O=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).UPLOAD_POINT="http://localhost:8080/",e.state={host:"",moderator:"",participant:"",h:[],m:[],p:[]},e.update=e.update.bind(Object(g.a)(e)),e}return Object(l.a)(n,[{key:"handleClick",value:function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.target.value),(new FormData).append("usertype",t.target.value),e.next=5,E.a.post("".concat(this.UPLOAD_POINT,"make"),{usertype:t.target.value,username:this.state[t.target.value],password:"password"});case 5:this.update();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("".concat(this.UPLOAD_POINT,"users"),{usertype:"host"});case 2:return t=e.sent,this.setState({h:t.data}),e.next=6,E.a.post("".concat(this.UPLOAD_POINT,"users"),{usertype:"moderator"});case 6:return n=e.sent,this.setState({m:n.data}),e.next=10,E.a.post("".concat(this.UPLOAD_POINT,"users"),{usertype:"participant"});case 10:a=e.sent,this.setState({p:a.data});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Outer"},r.a.createElement("div",{className:"Inner"},r.a.createElement("div",{className:"makes"},r.a.createElement("input",{onChange:function(t){return e.setState(Object(v.a)({},t.target.name,t.target.value))},type:"text",name:"host",id:"host"}),r.a.createElement("input",{type:"submit",value:"host",onClick:function(t){return e.handleClick(t)}}),this.state.h.map((function(e){return r.a.createElement("p",null,e._id)}))),r.a.createElement("div",{className:"makes"},r.a.createElement("input",{onChange:function(t){return e.setState(Object(v.a)({},t.target.name,t.target.value))},type:"text",name:"moderator",id:"moderator"}),r.a.createElement("input",{type:"submit",value:"moderator",onClick:function(t){return e.handleClick(t)}}),this.state.m.map((function(e){return r.a.createElement("p",null,e._id)}))),r.a.createElement("div",{className:"makes"},r.a.createElement("input",{onChange:function(t){return e.setState(Object(v.a)({},t.target.name,t.target.value))},type:"text",name:"participant",id:"participant"}),r.a.createElement("input",{type:"submit",value:"participant",onClick:function(t){return e.handleClick(t)}}),this.state.p.map((function(e){return r.a.createElement("p",null,e._id)}))))))}}]),n}(a.Component),j=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).state={view:["",""]},e.handleSubmit=e.handleSubmit.bind(Object(g.a)(e)),e}return Object(l.a)(n,[{key:"handleSubmit",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("http://localhost:8080/make_room");case 2:return e.next=4,e.sent.data;case 4:t=e.sent,console.log(t),this.setState({view:[t.password,t._id]},(function(){return console.log(n.state.view)}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Outer"},r.a.createElement("div",{className:"Inner",style:{display:"block"}},r.a.createElement("input",{type:"submit",value:"Create Room",onClick:this.handleSubmit}),r.a.createElement("br",null),r.a.createElement("p",null,"RoomId:",this.state.view[1],r.a.createElement("br",null),"Password:",this.state.view[0]))))}}]),n}(a.Component),k=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).state={room_id:"5eba22e546181cdde18e4d69",username:"",data:""},e.handleSubmit=e.handleSubmit.bind(Object(g.a)(e)),e}return Object(l.a)(n,[{key:"handleSubmit",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("http://localhost:8080/add_to_room",{username:this.state.username,room_id:this.state.room_id});case 2:t=e.sent,this.setState({data:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Outer"},r.a.createElement("div",{className:"Inner",style:{display:"block"}},"RoomId",r.a.createElement("input",{type:"text",name:"room_id",id:"room_id",onChange:function(t){return e.setState(Object(v.a)({},t.target.name,t.target.value))},value:"5eba22e546181cdde18e4d69"}),r.a.createElement("br",null),"UserName",r.a.createElement("input",{type:"text",name:"username",id:"username",onChange:function(t){return e.setState(Object(v.a)({},t.target.name,t.target.value))}}),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",value:"Join",onClick:function(){return e.handleSubmit()}}),this.state.data)))}}]),n}(a.Component),w=n(22),S=n.n(w),_=n(74),C=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).state={local:"",count:0},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n,a,r,o,c=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return navigator.getWebcam=navigator.getUserMedia||navigator.webKitGetUserMedia||navigator.moxGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,(t=navigator.mediaDevices.getUserMedia)&&t({video:{facingMode:"user"},audio:!0}).then((function(e){c.setState({local:e});var t=document.querySelector("video#local");t.srcObject=e,t.onloadedmetadata=function(e){t.play()}})),n=_.parse(this.props.location.search).room,a=_.parse(this.props.location.search).peer,e.next=7,E.a.post("http://localhost:8080/calls",{room_id:n});case 7:r=e.sent,(o=new S.a(a,{host:"2f86ad1c.ngrok.io",path:"/myapp",secure:!0})).on("open",(function(){console.log("open")})),o.on("connection",(function(e){e.on("data",(function(e){console.log(e)})),e.on("error",(function(e){return console.log(e)})),e.on("open",(function(){return console.log("conn open")})),e.on("close",(function(){return console.log("conn closed")}))})),o.on("call",(function(e){e.answer(c.state.local),e.on("stream",(function(e){c.setState({remote:e});var t=c.state.count+1;c.setState({count:t});var n=document.querySelector(".remotes").appendChild(document.createElement("video"));n.srcObject=e,n.onloadedmetadata=function(e){n.play()}}))})),r=r.data.filter((function(e){return e!==a})),console.log(r),r.map((function(e){var t=o.connect(e);t.on("error",(function(e){return console.log(e)})),t.on("open",(function(){t.send("hi!")}));var n=o.call(e,c.state.local);console.log(n),n.on("stream",(function(e){c.setState({remote:e});var t=document.querySelector("video#remote");t.srcObject=e,t.onloadedmetadata=function(e){t.play()}}))}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("video",{src:"",id:"local"}),r.a.createElement("br",null),r.a.createElement("div",{className:"remotes"},r.a.createElement("video",{src:"",id:"remote"})))}}]),n}(a.Component),x=function(e){Object(m.a)(o,e);var t=Object(u.a)(o);function o(){var e;return Object(s.a)(this,o),(e=t.call(this)).state={id:n(87).v4()},e.connect=e.connect.bind(Object(g.a)(e)),e.stream=e.stream.bind(Object(g.a)(e)),e}return Object(l.a)(o,[{key:"connect",value:function(){var e=this.state.peer.connect(this.state.conn_id);e.on("error",(function(e){return console.log(e)})),e.on("open",(function(){e.send("hi!")}))}},{key:"stream",value:function(){var e=this;this.state.peer.call(this.state.conn_id,this.state.local).on("stream",(function(t){e.setState({remote:t});var n=document.querySelector("video#remote");n.srcObject=t,n.onloadedmetadata=function(e){n.play()}}))}},{key:"componentDidMount",value:function(){var e=this;navigator.getWebcam=navigator.getUserMedia||navigator.webKitGetUserMedia||navigator.moxGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var t=navigator.mediaDevices.getUserMedia;t&&t({video:{facingMode:"user"},audio:!0}).then((function(t){e.setState({local:t});var n=document.querySelector("video#local");n.srcObject=t,n.onloadedmetadata=function(e){n.play()}}));var n=new S.a(this.state.id,{host:"add52cc587dc.ngrok.io",path:"/myapp",secure:!0});this.setState({peer:n}),n.on("open",(function(){console.log("open")})),n.on("connection",(function(e){e.on("data",(function(e){console.log(e)})),e.on("error",(function(e){return console.log(e)})),e.on("open",(function(){return console.log("conn open")})),e.on("close",(function(){return console.log("conn closed")}))})),n.on("call",(function(t){t.answer(e.state.local),t.on("stream",(function(t){e.setState({remote:t});var n=document.querySelector("video#remote");n.srcObject=t,n.onloadedmetadata=function(e){n.play()}}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement(a.Fragment,null,this.state.id,r.a.createElement("div",{className:""},r.a.createElement("video",{muted:!0,style:{transform:"scaleX(-1)"},id:"local",src:""})),r.a.createElement("div",null,r.a.createElement("input",{type:"text",name:"conn_id",onChange:function(t){return e.setState({conn_id:t.target.value},(function(){return console.log(e.state)}))}}),r.a.createElement("input",{type:"submit",className:"btn",value:"connect",onClick:function(t){e.connect()}})),r.a.createElement("div",{className:""},r.a.createElement("input",{type:"button",className:"btn",value:"stream",onClick:function(){return e.stream()}})),r.a.createElement("div",{className:""},r.a.createElement("video",{id:"remote",src:""})))}}]),o}(a.Component),N=function(e){Object(m.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,null,r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/create"},r.a.createElement(O,null)),r.a.createElement(p.a,{path:"/make_room"},r.a.createElement(j,null)),r.a.createElement(p.a,{path:"/join"},r.a.createElement(k,null)),r.a.createElement(p.a,{path:"/user_call",component:C}),r.a.createElement(p.a,{path:"/"},r.a.createElement(x,null)))))}}]),n}(a.Component),U=n(21);var M=Object(U.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hello:[]},t=arguments.length>1?arguments[1]:void 0;return"ADD_HELLO"===t.type&&e.hello.push(t.payload),e}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{store:M},r.a.createElement(N,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[45,1,2]]]);
//# sourceMappingURL=main.966c276e.chunk.js.map